<h1>Tubecams</h1>

<% if user_signed_in? && current_user.admin_role? %>
    <div class="text-right">
      <%= link_to 'Neue Tubecam erstellen', new_tubecam_device_path, class: 'btn btn-primary' %>
    </div>
<% end %>

<table class="table table-striped table-sm table-responsive table-hover">
  <thead>
  <tr>
    <th>#</th>
    <th>Seriennummer</th>
    <% if current_user.admin_role? %>
        <th>Benutzer</th>
    <% end %>
    <th>Beschreibung</th>
    <th>Aktiv</th>
    <th colspan="3"></th>
  </tr>
  </thead>

  <tbody>
  <% @tubecam_devices.each do |tubecam_device| %>
      <% user = tubecam_device.user %>

      <tr <%= !tubecam_device.active ? ' class=deleted' : '' %> >
        <td><%= tubecam_device.id %></td>
        <td><%= tubecam_device.serialnumber %></td>
        <% if current_user.admin_role? %>
            <td><%= user.username %> (<%= user.id %>)</td>
        <% end %>
        <td><%= tubecam_device.description %></td>
        <td><%= tubecam_device.active ? '✔' : '-' %></td>
        <td><%= link_to 'Anzeigen', tubecam_device_path(tubecam_device) %></td>
        <% if current_user.admin_role? || current_user.trapper_role? %>
            <td><%= link_to 'Ändern', edit_tubecam_device_path(tubecam_device) %></td>
        <% end %>
        <% if current_user.admin_role? %>
            <% if tubecam_device.active? %>
                <td><%= link_to 'Löschen', :controller => 'tubecam_devices', :action => 'delete', :id => tubecam_device.id %></td>
            <% else %>
                <td><%= link_to 'Aktivieren', :controller => 'tubecam_devices', :action => 'activate', :id => tubecam_device.id %></td>
            <% end %>
        <% end %>
      </tr>
  <% end %>
  </tbody>
</table>